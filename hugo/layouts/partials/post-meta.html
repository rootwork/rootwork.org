{{/*

Adding lastmod and date variables and markup to show a last-edited date.

Inserting CATEGORIES section and separating out TAGS section.

Removing 'writeSeparator' = true

*/}}
{{ $lastmod := .Lastmod.Format "2006-01-02" }}
{{ $date := .Date.Format "2006-01-02" }}
{{- $showShare := ne (.Param "showshare") false }}
{{- $showDate := ne (.Param "showdate") false }}
{{- $showReadTime := ne (.Param "showreadtime") false }}
{{- $showPostMeta := or ($showShare) ($showDate) ($showReadTime) (isset .Params "tags") }}
{{- $scratch := newScratch }}
{{- $scratch.Set "writeSeparator" false }}
{{- if $showPostMeta }}
  <div class="post_meta">
{{- end }}
  {{- if $showDate }}
    <span>{{ partial "sprite" (dict "icon" "calendar") }}</span>
    <span class="post_date">
      {{ .Date.Format (default "Jan 2, 2006" $.Site.Params.dateFormat) -}}
      {{ if ne $lastmod $date }}
        <span class="post_date__edit">&nbsp;Edited on {{ .Lastmod.Format (default "Jan 2, 2006" $.Site.Params.dateFormat) }}&nbsp;</span>
      {{ end }}
    </span>
  {{- end }}
  {{- if $showReadTime }}
    <span class="post_time">{{ if ($scratch.Get "writeSeparator") }} 路 {{ end }}{{ T "reading_time" . }}</span>
  {{- end }}

  {{/* CATEGORIES */}}
  {{- with .Params.categories -}}
    <span>
      {{- if ($scratch.Get "writeSeparator") }}&nbsp;路 {{ end }}
      {{- range . }}
        {{- $tag := urlize . -}}
        <a href='{{ absLangURL (printf "categories/%s" $tag) }}' title="{{ humanize . }}" class="post_tag--cat post_tag button button_translucent">
          {{- . }}
        </a>
      {{- end }}
    </span>
  {{- end }}

  {{/* TAGS */}}
  {{- with .Params.tags -}}
    <span>
      {{- if ($scratch.Get "writeSeparator") }}&nbsp;路 {{ end }}
      {{- range . }}
        {{- $tag := urlize . -}}
        <a href='{{ absLangURL (printf "tags/%s" $tag) }}' title="{{ humanize . }}" class="post_tag button button_translucent">
          {{- . }}
        </a>
      {{- end }}
    </span>
  {{- end }}

  {{- if $showShare }}
    <span class="page_only">{{ if ($scratch.Get "writeSeparator") }}&nbsp;路{{ end }}{{ partial "share" . }}</span>
  {{- end }}
{{- if $showPostMeta }}
  </div>
{{- end }}
